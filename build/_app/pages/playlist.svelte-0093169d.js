import{S as t,i as s,s as e,l as a,f as n,e as r,k as o,t as i,c as l,a as c,n as d,g as h,d as u,b as f,D as v,E as m,h as p,L as $,F as g,H as w,r as k,u as I,v as y,N as b,z as E,y as D,B as x,O as V,a1 as j,a2 as R,a3 as A,j as N,m as T,o as q,w as F,J as H}from"../chunks/vendor-78501628.js";import{p as L}from"../chunks/stores-3cedefcf.js";import{i as C,f as P,c as S,v as O}from"../chunks/helper-986d7f78.js";import{A as z}from"../chunks/AsyncError-0c3cf1fd.js";import{A as B}from"../chunks/AsyncLoading-3ebe9c9a.js";import{V as G,a as J}from"../chunks/VideoInfo-95becba0.js";import"../chunks/Loader-60714795.js";import"../chunks/ImageLoader-7c2b3bfa.js";import"../chunks/Subscribe-c3383543.js";function M(t,s,e){const a=t.slice();return a[7]=s[e],a[9]=e,a}function U(t){let s,e=t[2],r=[];for(let a=0;a<e.length;a+=1)r[a]=K(M(t,e,a));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();s=a()},l(t){for(let s=0;s<r.length;s+=1)r[s].l(t);s=a()},m(t,e){for(let s=0;s<r.length;s+=1)r[s].m(t,e);n(t,s,e)},p(t,a){if(31&a){let n;for(e=t[2],n=0;n<e.length;n+=1){const o=M(t,e,n);r[n]?r[n].p(o,a):(r[n]=K(o),r[n].c(),r[n].m(s.parentNode,s))}for(;n<r.length;n+=1)r[n].d(1);r.length=e.length}},d(t){$(r,t),t&&u(s)}}}function K(t){let s,e,a,$,g,w,k,I,y,b,E,D=t[7].title+"";function x(){return t[5](t[7],t[9])}return{c(){s=r("div"),e=r("img"),g=o(),w=r("div"),k=i(D),I=o(),this.h()},l(t){s=l(t,"DIV",{class:!0});var a=c(s);e=l(a,"IMG",{src:!0,alt:!0,class:!0}),g=d(a),w=l(a,"DIV",{class:!0});var n=c(w);k=h(n,D),n.forEach(u),I=d(a),a.forEach(u),this.h()},h(){e.src!==(a="https://"+t[1]+"/vi/"+t[3](t[7].videoThumbnails))&&f(e,"src",a),f(e,"alt",$=t[7].thumbnail),f(e,"class","svelte-vcksa5"),f(w,"class","title svelte-vcksa5"),f(s,"class",y="wrapper "+(t[0]===t[9]?"active":"")+" svelte-vcksa5")},m(t,a){n(t,s,a),v(s,e),v(s,g),v(s,w),v(w,k),v(s,I),b||(E=m(s,"click",x),b=!0)},p(n,r){t=n,6&r&&e.src!==(a="https://"+t[1]+"/vi/"+t[3](t[7].videoThumbnails))&&f(e,"src",a),4&r&&$!==($=t[7].thumbnail)&&f(e,"alt",$),4&r&&D!==(D=t[7].title+"")&&p(k,D),1&r&&y!==(y="wrapper "+(t[0]===t[9]?"active":"")+" svelte-vcksa5")&&f(s,"class",y)},d(t){t&&u(s),b=!1,E()}}}function Q(t){let s,e=t[2]&&t[1]&&U(t);return{c(){e&&e.c(),s=a()},l(t){e&&e.l(t),s=a()},m(t,a){e&&e.m(t,a),n(t,s,a)},p(t,[a]){t[2]&&t[1]?e?e.p(t,a):(e=U(t),e.c(),e.m(s.parentNode,s)):e&&(e.d(1),e=null)},i:g,o:g,d(t){e&&e.d(t),t&&u(s)}}}function W(t,s,e){let{aktiv:a}=s,{chosen:n}=s,{videos:r}=s;const o=w(),i=(t,s)=>{if(a===s)return!1;o("play",t)};return t.$$set=t=>{"aktiv"in t&&e(0,a=t.aktiv),"chosen"in t&&e(1,n=t.chosen),"videos"in t&&e(2,r=t.videos)},[a,n,r,t=>{const s=t.findIndex((t=>"medium"===t.quality));return s>-1&&t[s].url.split("/vi/")[1]},i,(t,s)=>i(t.videoId,s)]}class X extends t{constructor(t){super(),s(this,t,W,Q,e,{aktiv:0,chosen:1,videos:2})}}function Y(t){let s;return{c(){s=i("ERROR: invalid playlistID")},l(t){s=h(t,"ERROR: invalid playlistID")},m(t,e){n(t,s,e)},p:g,i:g,o:g,d(t){t&&u(s)}}}function Z(t){let s,e,a,o={ctx:t,current:null,token:null,hasCatch:!0,pending:at,then:tt,catch:_,value:15,error:16,blocks:[,,,]};return R(e=t[6](t[5],t[2]),o),{c(){s=r("div"),o.block.c(),this.h()},l(t){s=l(t,"DIV",{class:!0});var e=c(s);o.block.l(e),e.forEach(u),this.h()},h(){f(s,"class","container")},m(t,e){n(t,s,e),o.block.m(s,o.anchor=null),o.mount=()=>s,o.anchor=null,a=!0},p(s,a){t=s,o.ctx=t,36&a&&e!==(e=t[6](t[5],t[2]))&&R(e,o)||A(o,t,a)},i(t){a||(y(o.block),a=!0)},o(t){for(let s=0;s<3;s+=1){const t=o.blocks[s];k(t)}a=!1},d(t){t&&u(s),o.block.d(),o.token=null,o=null}}}function _(t){let s,e;return s=new z({props:{error:t[16]}}),{c(){N(s.$$.fragment)},l(t){T(s.$$.fragment,t)},m(t,a){q(s,t,a),e=!0},p(t,e){const a={};36&e&&(a.error=t[16]),s.$set(a)},i(t){e||(y(s.$$.fragment,t),e=!0)},o(t){k(s.$$.fragment,t),e=!1},d(t){F(s,t)}}}function tt(t){let s,e,a,m,$,g,w,b,E,D,V,j,R,A,L,C,P,S=t[15].title+"",O=t[15].author+"",z=t[0]&&st(t);return C=new X({props:{active:rt,chosen:t[5],videos:t[15].videos,aktiv:t[15].videos.findIndex(t[11])}}),C.$on("play",t[7]),{c(){s=r("div"),e=r("div"),a=r("h3"),m=i(S),$=o(),g=r("h4"),w=r("span"),b=i("by:"),E=o(),D=i(O),V=o(),j=r("div"),R=r("div"),z&&z.c(),A=o(),L=r("div"),N(C.$$.fragment),this.h()},l(t){s=l(t,"DIV",{class:!0});var n=c(s);e=l(n,"DIV",{class:!0});var r=c(e);a=l(r,"H3",{});var o=c(a);m=h(o,S),o.forEach(u),$=d(r),g=l(r,"H4",{});var i=c(g);w=l(i,"SPAN",{});var f=c(w);b=h(f,"by:"),f.forEach(u),E=d(i),D=h(i,O),i.forEach(u),r.forEach(u),V=d(n),j=l(n,"DIV",{class:!0});var v=c(j);R=l(v,"DIV",{class:!0});var p=c(R);z&&z.l(p),p.forEach(u),A=d(v),L=l(v,"DIV",{class:!0,style:!0});var k=c(L);T(C.$$.fragment,k),k.forEach(u),v.forEach(u),n.forEach(u),this.h()},h(){f(e,"class","info svelte-wy8hd"),f(R,"class","video svelte-wy8hd"),f(L,"class","videoList svelte-wy8hd"),H(L,"height",(t[4]?t[4].offsetHeight-1:0)+"px"),H(L,"overflow","auto"),f(j,"class","wrapper svelte-wy8hd"),f(s,"class","playlist")},m(t,r){n(t,s,r),v(s,e),v(e,a),v(a,m),v(e,$),v(e,g),v(g,w),v(w,b),v(g,E),v(g,D),v(s,V),v(s,j),v(j,R),z&&z.m(R,null),v(j,A),v(j,L),q(C,L,null),P=!0},p(t,s){(!P||36&s)&&S!==(S=t[15].title+"")&&p(m,S),(!P||36&s)&&O!==(O=t[15].author+"")&&p(D,O),t[0]?z?(z.p(t,s),1&s&&y(z,1)):(z=st(t),z.c(),y(z,1),z.m(R,null)):z&&(x(),k(z,1,1,(()=>{z=null})),I());const e={};32&s&&(e.chosen=t[5]),36&s&&(e.videos=t[15].videos),37&s&&(e.aktiv=t[15].videos.findIndex(t[11])),C.$set(e),(!P||16&s)&&H(L,"height",(t[4]?t[4].offsetHeight-1:0)+"px")},i(t){P||(y(z),y(C.$$.fragment,t),P=!0)},o(t){k(z),k(C.$$.fragment,t),P=!1},d(t){t&&u(s),z&&z.d(),F(C)}}}function st(t){let s,r,o=t[0],i=et(t);return{c(){i.c(),s=a()},l(t){i.l(t),s=a()},m(t,e){i.m(t,e),n(t,s,e),r=!0},p(t,a){1&a&&e(o,o=t[0])?(x(),k(i,1,1,g),I(),i=et(t),i.c(),y(i),i.m(s.parentNode,s)):i.p(t,a)},i(t){r||(y(i),r=!0)},o(t){k(i),r=!1},d(t){t&&u(s),i.d(t)}}}function et(t){let s,e,a,i,h,v;return e=new G({props:{chosen:t[5],videoAPI:t[1],borderRadiusTop:!1}}),h=new J({props:{chosen:t[5],videoAPI:t[1]}}),{c(){s=r("div"),N(e.$$.fragment),a=o(),i=r("div"),N(h.$$.fragment),this.h()},l(t){s=l(t,"DIV",{class:!0});var n=c(s);T(e.$$.fragment,n),n.forEach(u),a=d(t),i=l(t,"DIV",{class:!0});var r=c(i);T(h.$$.fragment,r),r.forEach(u),this.h()},h(){f(s,"class","top svelte-wy8hd"),f(i,"class","bottom")},m(r,o){n(r,s,o),q(e,s,null),t[10](s),n(r,a,o),n(r,i,o),q(h,i,null),v=!0},p(t,s){const a={};32&s&&(a.chosen=t[5]),2&s&&(a.videoAPI=t[1]),e.$set(a);const n={};32&s&&(n.chosen=t[5]),2&s&&(n.videoAPI=t[1]),h.$set(n)},i(t){v||(y(e.$$.fragment,t),y(h.$$.fragment,t),v=!0)},o(t){k(e.$$.fragment,t),k(h.$$.fragment,t),v=!1},d(n){n&&u(s),F(e),t[10](null),n&&u(a),n&&u(i),F(h)}}}function at(t){let s,e;return s=new B({props:{chosen:t[5]}}),{c(){N(s.$$.fragment)},l(t){T(s.$$.fragment,t)},m(t,a){q(s,t,a),e=!0},p(t,e){const a={};32&e&&(a.chosen=t[5]),s.$set(a)},i(t){e||(y(s.$$.fragment,t),e=!0)},o(t){k(s.$$.fragment,t),e=!1},d(t){F(s,t)}}}function nt(t){let s,e,r,o;const i=[Z,Y],l=[];function c(t,s){return t[3]?0:1}return s=c(t),e=l[s]=i[s](t),{c(){e.c(),r=a()},l(t){e.l(t),r=a()},m(t,e){l[s].m(t,e),n(t,r,e),o=!0},p(t,[a]){let n=s;s=c(t),s===n?l[s].p(t,a):(x(),k(l[n],1,1,(()=>{l[n]=null})),I(),e=l[s],e?e.p(t,a):(e=l[s]=i[s](t),e.c()),y(e,1),e.m(r.parentNode,r))},i(t){o||(y(e),o=!0)},o(t){k(e),o=!1},d(t){l[s].d(t),t&&u(r)}}}let rt=0;function ot(t,s,e){let a,n,r,o,i,l,c;b(t,L,(t=>e(12,a=t))),b(t,C,(t=>e(9,n=t))),b(t,P,(t=>e(5,r=t)));let d,h=!1;const u=()=>{e(2,l=a.query.get("list")),e(3,c=O(l))},f=async(t,s)=>{t||(t=S(n));try{const e=await fetch(`https://${t}/api/v1/videos/${s}?fields=error,videoId,title,descriptionHtml,published,keywords,viewCount,likeCount,dislikeCount,paid,premium,isFamilyFriendly,author,authorId,authorThumbnails,lengthSeconds,allowRatings,rating,isListed,liveNow,dashUrl,adaptiveFormats,formatStreams,captions,recommendedVideos,subCountText`),a=await e.json();if(a.videoId)return a;throw new Error("no kurwa???")}catch(a){const s=n.findIndex((s=>s[0]===t));if(s<0)return e(8,h=!0);throw V(C,n[s][1].failedRequests++,n),V(C,n[s][1].lastFailedRequest=(new Date).getTime(),n),C.set(n),e(8,h=!0),new Error(a)}};E((()=>u())),D((()=>u()));return t.$$.update=()=>{768&t.$$.dirty&&h&&(e(8,h=!1),V(P,r=S(n),r))},[o,i,l,c,d,r,async(t,s)=>{t||(t=S(n));try{console.log("start");const a=await fetch(`https://${t}/api/v1/playlists/${s}`),n=await a.json();if(n.playlistId&&n.videos)return e(0,o=n.videos[0].videoId),e(1,i=await f(t,o)),n;throw new Error(n)}catch(a){const s=n.findIndex((s=>s[0]===t));if(s<0)return e(8,h=!0);throw V(C,n[s][1].failedRequests++,n),V(C,n[s][1].lastFailedRequest=(new Date).getTime(),n),C.set(n),e(8,h=!0),new Error(a)}},async t=>{e(0,o=t.detail),e(1,i=await f(r,o))},h,n,function(t){j[t?"unshift":"push"]((()=>{d=t,e(4,d)}))},t=>t.videoId===o]}export default class extends t{constructor(t){super(),s(this,t,ot,nt,e,{})}}
//# sourceMappingURL=playlist.svelte-0093169d.js.map
